-- create database bcnetwork;

use bcnetwork;

 CREATE TABLE blood_types (
    blood_type VARCHAR(3) PRIMARY KEY
);


CREATE TABLE organizations (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(255) NOT NULL UNIQUE,
    type VARCHAR(255) NOT NULL
);



 CREATE TABLE addresses (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    user_id BIGINT,
    street_number VARCHAR(50),
    street_name VARCHAR(255),
    city VARCHAR(100),
    state VARCHAR(100),
    zip_code VARCHAR(20),
    FOREIGN KEY (user_id) REFERENCES users(id)
);


CREATE TABLE users (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    first_name VARCHAR(255) NOT NULL,
    last_name VARCHAR(255) NOT NULL,
    username VARCHAR(255) NOT NULL UNIQUE,
    password VARCHAR(255) NOT NULL,
    email VARCHAR(255) NOT NULL UNIQUE,
    blood_type VARCHAR(3) NOT NULL,
    contact_number VARCHAR(20) NOT NULL,
    contact_number_2 VARCHAR(20),
    nic VARCHAR(20),
    dob DATE,
    user_role ENUM('ADMIN', 'USER', 'SUPER_ADMIN') NOT NULL,
    status ENUM('ACTIVE', 'INACTIVE') NOT NULL DEFAULT 'ACTIVE',
    organization_id BIGINT,
    is_new_user BOOLEAN NOT NULL DEFAULT TRUE,
    FOREIGN KEY (blood_type) REFERENCES blood_types(blood_type),
    FOREIGN KEY (address_id) REFERENCES addresses(id),
    FOREIGN KEY (organization_id) REFERENCES organizations(id)
);


CREATE TABLE user_documents (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    file_name VARCHAR(255) NOT NULL,
    file_type VARCHAR(50) NOT NULL,
    file_size BIGINT NOT NULL,
    data LONGBLOB NOT NULL,
    user_id BIGINT NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id)
);

-- creating deafult admin

INSERT INTO blood_types (blood_type) VALUES
    ('A+'),
    ('A-'),
    ('B+'),
    ('B-'),
    ('AB+'),
    ('AB-'),
    ('O+'),
    ('O-');

INSERT INTO addresses (street_number, street_name, city, state, zip_code) VALUES
('123', 'Admin Street', 'Admin City', 'Admin State', '12345');

INSERT INTO organizations (name, type) VALUES ('Blood Bank', 'MAIN');

INSERT INTO users (
    first_name,
    last_name,
    username,
    password,
    email,
    blood_type,
    contact_number,
    user_role,
    address_id,
    organization_id,
    status,
    is_new_user
) VALUES (
    'Admin',
    'User',
    'admin',
    '123',
    'bcnetadmin@yopmail.com',
    'A+',
    '000-000-0000',
    'ADMIN',
    1,
    1,
    'ACTIVE',
    TRUE
);

select * from users;
select * from user_documents;










